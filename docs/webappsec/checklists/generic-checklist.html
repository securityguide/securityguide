<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Generic Pre-flight Checklist</title>

  <link rel="shortcut icon" type="image/ico" href="/security/assets/favicon.ico">

  <!-- no custom css detected -->

  
  <meta name="description" content="Generic Pre-flight Checklist" />
  

  <link rel="stylesheet" href="/security/assets/main.css">
  <link rel="alternate" type="application/rss+xml" title="ThoughtWorks Security Guide" href="/security/feed.xml">

  <script src="/security/assets/simple-jekyll-search.min.js"></script>
  <script>
    document.addEventListener("DOMContentLoaded", function(event) {
      SimpleJekyllSearch({
        searchInput: document.getElementById("search-input"),
        resultsContainer: document.getElementById("results-container"),
        searchResultTemplate: '<li class="list-group-item"><a href="{url}">{title}</a></li>',
        noResultsText: '<li class="list-group-item">No Results<li>',
        json: "/security/assets/search.json"
      })
    });
  </script>
</head>
  <body>
    <header>
  <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
    <a class="navbar-brand" href="/">ThoughtWorks Security Guide</a>
    <div class="collapse navbar-collapse">
      <div class="mr-auto"></div>
      <div id="search-container">
        <input type="text" class="form-control" id="search-input" placeholder="Search">
        <ul id="results-container" class="list-group"></ul>
      </div>
    </div>
  </nav>
</header>

    <div class="container-fluid">
      <div class="row">
        <nav class="col-sm-3 col-md-3 d-none d-sm-block bg-light sidebar">
  <ul class="nav nav-pills flex-column">
    <li class="nav-level-0 nav-item">
  <a class="nav-level-0 nav-link " href="/security/">Home</a>
</li>
<li class="nav-level-0 nav-item">
  <a class="nav-level-0 nav-link " href="/security/webappsec/">Web Application Security</a>
</li><li class="nav-level-1 nav-item">
  <a class="nav-level-1 nav-link " href="/security/webappsec/fundamentals/">Fundamentals</a>
</li>
<li class="nav-level-1 nav-item">
  <a class="nav-level-1 nav-link " href="/security/webappsec/checklists/">Checklists</a>
</li><li class="nav-level-2 nav-item">
  <a class="nav-level-2 nav-link active" href="/security/webappsec/checklists/generic-checklist.html">Generic</a>
</li>
<li class="nav-level-2 nav-item">
  <a class="nav-level-2 nav-link " href="/security/webappsec/checklists/ruby-checklists/">Ruby</a>
</li>
<li class="nav-level-2 nav-item">
  <a class="nav-level-2 nav-link " href="/security/webappsec/checklists/javascript-checklists/">Javascript</a>
</li>
<li class="nav-level-1 nav-item">
  <a class="nav-level-1 nav-link " href="/security/webappsec/best-practices/">Best Practices</a>
</li>
<li class="nav-level-1 nav-item">
  <a class="nav-level-1 nav-link " href="/security/webappsec/tools/">Tools</a>
</li>
<li class="nav-level-0 nav-item">
  <a class="nav-level-0 nav-link " href="/security/netsec/">Network Security</a>
</li>
<li class="nav-level-0 nav-item">
  <a class="nav-level-0 nav-link " href="/security/opsec/">Operations Security</a>
</li>
  </ul>
</nav>



        <main role="main" class="col-sm-9 ml-sm-auto col-md-9 pt-3">
          <h1 class="title">Generic Pre-flight Checklist</h1>
          <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#configuration">Configuration</a>
<ul>
<li class="toc-entry toc-h3"><a href="#secrets-are-stored-securely">Secrets are stored securely</a></li>
<li class="toc-entry toc-h3"><a href="#anti-csrf-is-enabled">Anti-CSRF is enabled</a></li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#cookies-and-sessions">Cookies and sessions</a></li>
<li class="toc-entry toc-h2"><a href="#http-headers">HTTP Headers</a></li>
<li class="toc-entry toc-h2"><a href="#secure-connections">Secure connections</a></li>
<li class="toc-entry toc-h2"><a href="#input-validation">Input Validation</a></li>
<li class="toc-entry toc-h2"><a href="#output-filtering">Output Filtering</a></li>
<li class="toc-entry toc-h2"><a href="#authorization">Authorization</a></li>
<li class="toc-entry toc-h2"><a href="#pipeline">Pipeline</a></li>
<li class="toc-entry toc-h2"><a href="#routing-and-urls">Routing and URLs</a></li>
<li class="toc-entry toc-h2"><a href="#documentation">Documentation</a></li>
<li class="toc-entry toc-h2"><a href="#logging">Logging</a></li>
</ul><h2 id="configuration">
<a id="configuration" class="anchor" href="#configuration" aria-hidden="true"><span class="octicon octicon-link"></span></a>Configuration</h2>

<h3 id="secrets-are-stored-securely">
<a id="secrets-are-stored-securely" class="anchor" href="#secrets-are-stored-securely" aria-hidden="true"><span class="octicon octicon-link"></span></a>Secrets are stored securely</h3>

<p>A “secret” includes passwords, API keys, and private keys.</p>

<ul>
  <li>No cleartext secrets in git</li>
  <li>Secrets may be:
    <ul>
      <li>Encrypted, (e.g. git-crypt)</li>
      <li>Stored in the environment</li>
      <li>Stored in secure storage (e.g. credstash)</li>
    </ul>
  </li>
</ul>

<h3 id="anti-csrf-is-enabled">
<a id="anti-csrf-is-enabled" class="anchor" href="#anti-csrf-is-enabled" aria-hidden="true"><span class="octicon octicon-link"></span></a>Anti-CSRF is enabled</h3>

<p>When a web browser submits a HTTP request, it dutifully includes all matching cookies, regardless of what web page the request came from. Without CSRF protection, a nefarious page can get your browser to make requests to a protected site while authenticated as you.</p>

<p>Remember:</p>

<ul>
  <li>Idempotent HTTP GET: You must remember to make all GET actions idempotent (does not change the data). This is because the Rails anti-CSRF only applies to HTTP POST.</li>
  <li>Images are not protected: Images and other assets are not protected by the Rails anti-CSRF or the same-origin policy. If you have images with sensitive information, then you need an additional system to prevent a third party site from stealing these images.</li>
  <li>If the application has a XSS vulnerability, then CSRF is also defeated.</li>
</ul>

<h2 id="cookies-and-sessions">
<a id="cookies-and-sessions" class="anchor" href="#cookies-and-sessions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Cookies and sessions</h2>

<ul>
  <li>Authentication always triggers a session reset</li>
  <li>data in cookies is untrusted, unless signed</li>
  <li>sessions have a max lifetime</li>
  <li>sessions expire after inactivity</li>
</ul>

<h2 id="http-headers">
<a id="http-headers" class="anchor" href="#http-headers" aria-hidden="true"><span class="octicon octicon-link"></span></a>HTTP Headers</h2>

<ul>
  <li>Enable secure headers</li>
  <li>Sensitive content is not cached</li>
</ul>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Cache-Control: max-age=0, private, no-store
</code></pre></div></div>

<h2 id="secure-connections">
<a id="secure-connections" class="anchor" href="#secure-connections" aria-hidden="true"><span class="octicon octicon-link"></span></a>Secure connections</h2>

<ul>
  <li>TLS is required in production</li>
  <li>Database connections are secure</li>
  <li>Other inputs and outputs</li>
  <li>APIs?</li>
</ul>

<h2 id="input-validation">
<a id="input-validation" class="anchor" href="#input-validation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Input Validation</h2>

<ul>
  <li>Input has restrictive validation</li>
  <li>All queries use parameter binding</li>
  <li>No mass assignment</li>
</ul>

<h2 id="output-filtering">
<a id="output-filtering" class="anchor" href="#output-filtering" aria-hidden="true"><span class="octicon octicon-link"></span></a>Output Filtering</h2>

<ul>
  <li>User input is not used to build file paths</li>
  <li>All output is filtered, even if the data has been previously validated.</li>
</ul>

<h2 id="authorization">
<a id="authorization" class="anchor" href="#authorization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Authorization</h2>

<ul>
  <li>Reasonable authentication system</li>
  <li>The default is to require authorization</li>
  <li>follows principles of least privilege</li>
</ul>

<h2 id="pipeline">
<a id="pipeline" class="anchor" href="#pipeline" aria-hidden="true"><span class="octicon octicon-link"></span></a>Pipeline</h2>

<ul>
  <li>Dependency checks are run in pipeline</li>
  <li>Static analysis is run in pipeline</li>
</ul>

<h2 id="routing-and-urls">
<a id="routing-and-urls" class="anchor" href="#routing-and-urls" aria-hidden="true"><span class="octicon octicon-link"></span></a>Routing and URLs</h2>

<ul>
  <li>There is no sensitive information in any application URLs</li>
  <li>All stylesheets have absolute paths</li>
</ul>

<h2 id="documentation">
<a id="documentation" class="anchor" href="#documentation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Documentation</h2>

<ul>
  <li>Purpose of application</li>
  <li>Security considerations</li>
  <li>How application is installed, configured, and run</li>
</ul>

<h2 id="logging">
<a id="logging" class="anchor" href="#logging" aria-hidden="true"><span class="octicon octicon-link"></span></a>Logging</h2>

<ul>
  <li>Logging is centralized</li>
</ul>

        </main>
      </div>
    </div>
  </body>
</html>